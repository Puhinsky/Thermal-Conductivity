Уравнение теплопроводности для одномерного случая:
$$\frac{\partial T(x,t)}{\partial t}=-\frac{\partial W(x,t)}{\partial x}+Q(x,t),$$
где $x$ – координата по пространству, $t$ – координата по времени, $T$ – функция температуры, $W$ – поток энергии через поперечное сечение, $Q$ – энергия, выделяемая истоником. \
При этом поток энергии равен:
$$W(x,t)=-a(x,t)\cdot\frac{\partial T(x,t)}{\partial x},$$
где $a$ – функция коэффициента температуропроводности. \
В рассматриваемом случае дополнительное тепло не выделяется $Q(x,t)=const=0$, а функция коэффициента температуропроводности зависит только от координаты по пространству $a(x)$:
$$\frac{\partial T(x,t)}{\partial t}=-\frac{\partial W(x,t)}{\partial x}$$
Поток энергии равен:
$$W(x,t)=-a(x)\cdot\frac{\partial T(x,t)}{\partial x}$$
Разностная неявная схема для изменения потока тепла на следующей строке по времени:
$$\frac{\partial W(x,t)}{\partial x}=\frac{W_{i+1}^{n+1}-W_{i-1}^{n+1}}{h},$$
где $h$ – шаг по пространству. \
Тогда:
$$W_{i+1}^{n+1}=-a_{i+1}^{n+1}\cdot\frac{T_{i+1}^{n+1}-T_{i}^{n+1}}{h}$$
$$W_{i-1}^{n+1}=-a_{i-1}^{n+1}\cdot\frac{T_{i}^{n+1}-T_{i-1}^{n+1}}{h}$$
Разностная неявная схема для одномерного уравнения теплопроводности:

<p align="center">
    <img width="50%" src="./Разностная_схема.svg">
</p>

$$\frac{T_{i}^{n+1}-T_{i}^{n}}{\tau}=-\frac{W_{i+1}^{n+1}-W_{i-1}^{n+1}}{h},$$
где $\tau$ – шаг по времени.
$$\frac{T_{i}^{n+1}-T_{i}^{n}}{\tau}=\frac{a_{i+1}^{n+1}\cdot\frac{T_{i+1}^{n+1}-T_{i}^{n+1}}{h}-a_{i-1}^{n+1}\cdot\frac{T_{i}^{n+1}-T_{i-1}^{n+1}}{h}}{h}$$
$$=\frac{a_{i+1}^{n+1}\cdot(T_{i+1}^{n+1}-T_{i}^{n+1})-a_{i-1}^{n+1}\cdot(T_{i}^{n+1}-T_{i-1}^{n+1})}{h^2}=$$
$$=\frac{a_{i+1}^{n+1}\cdot T_{i+1}^{n+1}-(a_{i+1}^{n+1}+a_{i-1}^{n+1})\cdot T_{i}^{n+1}+a_{i-1}^{n+1}\cdot T_{i-1}^{n+1}}{h^2}$$
Приведем выражение в линейный вид:
$$T_{i}^{n+1}-T_{i}^{n}=\frac{\tau}{h^2}\cdot\biggl(a_{i+1}^{n+1}\cdot T_{i+1}^{n+1}-(a_{i+1}^{n+1}+a_{i-1}^{n+1})\cdot T_{i}^{n+1}+a_{i-1}^{n+1}\cdot T_{i-1}^{n+1}\biggr)$$
$$a_{i+1}^{n+1}\cdot(-\frac{\tau}{h^2})\cdot T_{i+1}^{n+1}+\biggl(1+(a_{i+1}^{n+1}+a_{i-1}^{n+1})\cdot\frac{\tau}{h^2}\biggr)\cdot T_{i}^{n+1}+a_{i-1}^{n+1}\cdot(-\frac{\tau}{h^2})\cdot T_{i-1}^{n+1}=T^{n}_{i}$$
На строке шириной M элементов:
