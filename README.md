Уравнение теплопроводности для одномерного случая:
$$\frac{\partial T(x,t)}{\partial t}=-\frac{\partial W(x,t)}{\partial x}+Q(x,t),$$
где $x$ – координата по пространству, $t$ – координата по времени, $T$ – функция температуры, $W$ – поток энергии через поперечное сечение, $Q$ – энергия, выделяемая истоником. \
При этом поток энергии равен:
$$W(x,t)=-a(x,t)\cdot\frac{\partial T(x,t)}{\partial x},$$
где $a$ – функция коэффициента температуропроводности. \
В рассматриваемом случае дополнительное тепло не выделяется $Q(x,t)=const=0$, а функция коэффициента температуропроводности зависит только от координаты по пространству $a(x)$:
$$\frac{\partial T(x,t)}{\partial t}=-\frac{\partial W(x,t)}{\partial x}$$
Поток энергии равен:
$$W(x,t)=-a(x)\cdot\frac{\partial T(x,t)}{\partial x}$$
Разностная неявная схема для изменения потока тепла на следующей строке по времени:
$$\frac{\partial W(x,t)}{\partial x}=\frac{W^{n+1}_{i+1}-W^{n+1}_{i-1}}{h},$$
где $h$ – шаг по пространству. \
Тогда:
$$W^{n+1}_{i+1}=-a^{n+1}_{i+1}\cdot\frac{T^{n+1}_{i+1}-T^{n+1}_{i}}{h}$$
$$W^{n+1}_{i-1}=-a^{n+1}_{i-1}\cdot\frac{T^{n+1}_{i}-T^{n+1}_{i-1}}{h}$$
Разностная неявная схема для одномерного уравнения теплопроводности:
$$\frac{T^{n+1}_{i}-T^{n}_{i}}{\tau}=-\frac{W^{n+1}_{i+1}-W^{n+1}_{i-1}}{h},$$
где $\tau$ – шаг по времени.
$$\frac{T^{n+1}_{i}-T^{n}_{i}}{\tau}=\frac{a^{n+1}_{i+1}\cdot\frac{T^{n+1}_{i+1}-T^{n+1}_{i}}{h}-a^{n+1}_{i-1}\cdot\frac{T^{n+1}_{i}-T^{n+1}_{i-1}}{h}}{h}=\frac{a^{n+1}_{i+1}\cdot(T^{n+1}_{i+1}-T^{n+1}_{i})-a^{n+1}_{i-1}\cdot(T^{n+1}_{i}-T^{n+1}_{i-1})}{h^2}=\\[8pt]=\frac{a^{n+1}_{i+1}\cdot T^{n+1}_{i+1}-(a^{n+1}_{i+1}+a^{n+1}_{i-1})\cdot T^{n+1}_{i}+a^{n+1}_{i-1}\cdot T^{n+1}_{i-1}}{h^2}$$
Приведем выражение в линейный вид:
$$T^{n+1}_{i}-T^{n}_{i}=\frac{\tau}{h^2}\cdot\biggl(a^{n+1}_{i+1}\cdot T^{n+1}_{i+1}-(a^{n+1}_{i+1}+a^{n+1}_{i-1})\cdot T^{n+1}_{i}+a^{n+1}_{i-1}\cdot T^{n+1}_{i-1}\biggr)$$
$$a^{n+1}_{i+1}\cdot(-\frac{\tau}{h^2})\cdot T^{n+1}_{i+1}+\biggl(1+(a^{n+1}_{i+1}+a^{n+1}_{i-1})\cdot\frac{\tau}{h^2}\biggr)\cdot T^{n+1}_{i}+a^{n+1}_{i-1}\cdot(-\frac{\tau}{h^2})\cdot T^{n+1}_{i-1}=T^{n}_{i}$$
На строке шириной M элементов:
